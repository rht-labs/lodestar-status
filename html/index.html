<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

<html>
  <div id="status-app">
    <div class="masthead">
      <div class="text-container">
        <span class="font-largest">Lodestar Status</span>
      </div>
    </div>
    <div class="content">
      <status-report :status="status" v-for="status in statuses" />
    </div>
  </div>
</html>

<script type="text/x-template" id="status-template">
  <div class="status-container">
    <p>{{ status.system }} <span :style="{ float: 'right' , color: statusColor[1]}">{{status.message}}</span></p>
  </div>
</script>
<script>
  Vue.component("status-report", {
    props: ["status"],
    template: "#status-template",
    computed: {
      statusColor: function () {
        switch (this.status.status) {
          case "healthy":
            return ["#1E4F18", "#3E8635"];
          case "degraded":
            return ["#A30000", "#C9190B"];
          case "warning":
            return ["#795600", "#F0AB00"];
          default:
            return ["grey", "grey"];
        }
      },
    },
  });
  var app = new Vue({
    el: "#status-app",
    data: {
      message: "Hello, Vue!",
      statuses: [{ message: "hello" }],
      statusService: statusService({ baseUrl: "hello" }),
    },
    mounted: async function () {
      statuses = await this.statusService.getStatuses();
      this.statuses = statuses;
    },
  });

  function statusService({ baseUrl }) {
    return {
      getStatuses: async function () {
        // TODO: Implement actual status service call
        return [
          {
            system: "Git API",
            message: "Operational",
            status: "healthy",
          },
          { message: "Down", status: "degraded", system: "Frontend" },
          { message: "Unreachable", status: "warning", system: "Dispatcher" },
        ];
      },
    };
  }
</script>
<link
  href="https://fonts.googleapis.com/css2?family=Red+Hat+Text&display=swap"
  rel="stylesheet"
/>
<link
  href="https://fonts.googleapis.com/css2?family=Red+Hat+Display&family=Red+Hat+Text&display=swap"
  rel="stylesheet"
/>
<link
  href="https://fonts.googleapis.com/css2?family=Overpass&display=swap"
  rel="stylesheet"
/>
<style>
  body {
    font-family: "Overpass", "proxima-nova", "Helvetica Neue", Helvetica, Arial,
      Sans-Serif;
    margin: 0;
  }
  .masthead {
    background-image: url("https://access.redhat.com/chrome_themes/nimbus/img/nimbus-hero_support.jpg");
    height: 315px;
    background-repeat: no-repeat;
    background-size: cover;
    background-position: center center;
    max-width: 100%;
    margin: 0 auto;
    position: relative;
    margin-bottom: 2rem;
  }
  html {
    margin: 0;
  }
  .masthead .text-container {
    position: absolute;
    bottom: 0px;
    left: 0px;
    right: 0px;
    padding: 1rem;
    max-width: 850px;
    margin: 0 auto;
  }
  .masthead .text-container span {
    color: white;
  }
  .font-large {
    font-size: 1.5rem;
  }
  .font-largest {
    font-size: 2rem;
  }
  .content {
    width: 90%;
    max-width: 850px;
    margin: 0 auto;
  }
  .status-container {
    border: 1px solid lightgrey;
    border-bottom-width: 0px;
    padding: 1.25rem 1.75rem;
  }
  .status-container:last-child {
    border-bottom-width: 1px;
  }
</style>
